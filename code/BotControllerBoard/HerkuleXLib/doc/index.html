<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>HerkuleXLib: HerkuleXLib documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="HerkuleXfigure.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HerkuleXLib
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Arduino library to drive HerkuleX DRS-0101 and DRS-0201</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">HerkuleXLib documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#limitations">Limitations</a></li>
<li class="level1"><a href="#inspiration">Inspiration</a></li>
<li class="level1"><a href="#qstart">Quick start</a><ul><li class="level2"><a href="#wiring">Wiring</a></li>
<li class="level2"><a href="#install">Installation of the library</a></li>
<li class="level2"><a href="#fcode">Your first program</a></li>
</ul>
</li>
<li class="level1"><a href="#license">License</a></li>
<li class="level1"><a href="#author">Author</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="limitations"></a>
Limitations</h1>
<p>Please consider the following comments to use the library:</p>
<ul>
<li>The use of this library requires reading the Herkulex Servo Manual (<a href="http://www.dongburobot.com/jsp/cms/view.jsp?code=100703&isSkin=Y&cmd=view&boardCode=100171&bseq=1407">http://www.dongburobot.com/jsp/cms/view.jsp?code=100703&amp;isSkin=Y&amp;cmd=view&amp;boardCode=100171&amp;bseq=1407</a>)</li>
<li>The library is compatible with Arduino IDE v1.x</li>
<li>The library has been tested on:<ol type="1">
<li>Arduino UNO: Serial is used for servo, printout* mode is NOT available.</li>
<li>Arduino MEGA: Serial1, Serial2 or Serial3 can be used for servo, Serial is used for printout*.</li>
<li>Arduino Micro: Serial1 is used for servo, Serial for printout*.</li>
</ol>
</li>
<li>The library can be theoretically be used on:<ol type="1">
<li>Arduino DUE: Serial1, Serial2 or Serial3 can be used for servo, Serial is used for printout*.</li>
<li>Arduino Leonardo: Serial1 is used for servo, Serial for printout*.</li>
</ol>
</li>
</ul>
<p>*The printout mode displays send/receive data and errors through the Serial Monitor on the computer</p>
<ul>
<li>From experience, the baud rate 57600 does NOT work properly. Please avoid using it</li>
<li>The ACK Policy shall be set to 1 (default value) for all servos to allow the library to work properly.</li>
<li>If several <a class="el" href="class_hkx_communication.html" title="Class to manage the communication. ">HkxCommunication</a> instances are created, their shall use different serial port.</li>
</ul>
<h1><a class="anchor" id="inspiration"></a>
Inspiration</h1>
<p>This work was inspired by the code from Alessandro Giacomel proposed here: <a href="http://robottini.altervista.org/dongbu-herkulex-arduino-library-2">http://robottini.altervista.org/dongbu-herkulex-arduino-library-2</a>. The software serial option was not considered because it is limited to a baud rate of 57600 bps that generates some communication problems to feedback informations from the servos to the Arduino card.</p>
<h1><a class="anchor" id="qstart"></a>
Quick start</h1>
<h2><a class="anchor" id="wiring"></a>
Wiring</h2>
<p>The wiring of the servo with an Arduino MEGA (on Serial1 port) is sketched and photographed below.</p>
<div class="image">
<img src="wiring_herkulex_arduino.png" alt="wiring_herkulex_arduino.png"/>
<div class="caption">
Wiring sketch of the HerkuleX with Arduino MEGA</div></div>
 <div class="image">
<img src="photo_wiring.jpg" alt="photo_wiring.jpg"/>
<div class="caption">
Wiring photo of the HerkuleX with Arduino MEGA</div></div>
<h2><a class="anchor" id="install"></a>
Installation of the library</h2>
<p>Download the last version of the library from: <a href="http://www.benoitpuel.com/blog/...zip">http://www.benoitpuel.com/blog/...zip</a></p>
<p>Open Arduino software and add the library as described here: <a href="https://www.arduino.cc/en/Guide/Libraries#toc4">https://www.arduino.cc/en/Guide/Libraries#toc4</a>. In a nutshell, go to menu Sketch &gt; Include Library &gt; Add .ZIP library, then select the library from your download folder.</p>
<h2><a class="anchor" id="fcode"></a>
Your first program</h2>
<p>The following example is proposed for the case of Arduino MEGA (see <a class="el" href="index.html#wiring">Wiring</a>).</p>
<p>For writing your first Arduino program using the HerkuleXLib library, first open Arduino software and create a new file (menu File &gt; New). Save it (menu File &gt; Save) as "MyFirstHerkuleXLib_MEGA". Include the library to the project (menu Sketch &gt; Include library &gt; HerkuleX). You should get the following code: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hkx_communication_8h.html">HkxCommunication.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hkx_group_pos_control_8h.html">HkxGroupPosControl.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hkx_pos_control_8h.html">HkxPosControl.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hkx_setup_8h.html">HkxSetup.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hkx_status_8h.html">HkxStatus.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  <span class="comment">// put your setup code here, to run once:</span></div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <span class="comment">// put your main code here, to run repeatedly:</span></div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --><p>Even if all the headers are not necessary, lets keep them all to avoid errors. Let's now create the instances for the printout, the communication and the control position for one servo. </p><div class="fragment"><div class="line">...</div>
<div class="line">void setup() {</div>
<div class="line">  <a class="code" href="class_hkx_print.html">HkxPrint</a> printout = <a class="code" href="class_hkx_print.html">HkxPrint</a>(Serial, 9600);  <span class="comment">// Printout errors on the serial monitor</span></div>
<div class="line">  <a class="code" href="class_hkx_communication.html">HkxCommunication</a> communication = <a class="code" href="class_hkx_communication.html">HkxCommunication</a>(HKX_115200, Serial1, printout);  <span class="comment">// Communication with the servo on Serial1</span></div>
<div class="line">  <a class="code" href="class_hkx_pos_control.html">HkxPosControl</a> servo(253, communication, printout);  <span class="comment">// control position for the servo ID=253 (factory default value)</span></div>
<div class="line">  </div>
<div class="line">}</div>
<div class="line">...</div>
</div><!-- fragment --><p>The servo has its LED and torque off (torque off means that you can turn the servo manually).</p>
<p>To turn the LED to red colour, add the following lines (more details here: <a class="el" href="class_hkx_pos_control.html#a5e5be6cd49b2b00809873d156a68d5dd" title="Set torque actuation and LED colour. ">HkxPosControl.setTorqueLEDControl()</a>). </p><div class="fragment"><div class="line">servo.setTorqueLEDControl(HKX_NO_VALUE, HKX_LED_RED);  <span class="comment">// set the LED to red</span></div>
<div class="line">Serial.println(F(<span class="stringliteral">&quot;--&gt; LED is now red&quot;</span>));</div>
<div class="line">delay(10000); <span class="comment">// wait 10 seconds</span></div>
</div><!-- fragment --><p>And I guess you bought this servo and install this library for one main purpose: moving the servo! The code below will execute the move and change the color of the LED to blue for the servo moving period only (more details here: <a class="el" href="class_hkx_pos_control.html#a48d56180c3ca792e525fd80dde6e5fae" title="Move position. ">HkxPosControl.movePosition()</a>). </p><div class="fragment"><div class="line">Serial.println(F(<span class="stringliteral">&quot;--&gt; Move to 45 degrees in 2 seconds, blue LED&quot;</span>));</div>
<div class="line">servo.movePosition(450, 2000, HKX_LED_BLUE, <span class="keyword">true</span>);  <span class="comment">// set the servo to 45° in 2 seconds, led turns to blue during the move</span></div>
<div class="line">Serial.println(F(<span class="stringliteral">&quot;--&gt; Move is finished, torque is free and LED back to red&quot;</span>));</div>
</div><!-- fragment --><p>One nice feature of this servo is that you can get some feedback measures. For instance, you can read the input voltage (voltage of the battery if powered with a battery) and the current position (more details here: <a class="el" href="class_hkx_pos_control.html#a4bea44ad831bfd951fd8a6ef08a26a0f" title="Get the servo behaviour. ">HkxPosControl.getBehaviour()</a>). </p><div class="fragment"><div class="line">uint16_t inputVoltage;</div>
<div class="line">int16_t position;</div>
<div class="line"><span class="comment">// get the current behaviour of the servo</span></div>
<div class="line">servo.getBehaviour(&amp;inputVoltage, HKX_NO_VALUE, &amp;position, HKX_NO_VALUE, HKX_NO_VALUE, HKX_NO_VALUE, HKX_NO_VALUE, HKX_NO_VALUE);</div>
<div class="line">Serial.print(F(<span class="stringliteral">&quot;--&gt; Input voltage is:&quot;</span>));</div>
<div class="line">Serial.println((<span class="keywordtype">float</span>)inputVoltage/1000);</div>
<div class="line">Serial.print(F(<span class="stringliteral">&quot;--&gt; Current position (degree) is:&quot;</span>));</div>
<div class="line">Serial.println((<span class="keywordtype">float</span>)position/10);</div>
</div><!-- fragment --><p>You can now compile and transfer the program, open the serial monitor and you should see the following display.</p>
<div class="image">
<img src="serial_monitor.png" alt="serial_monitor.png"/>
<div class="caption">
Serial monitor while executing MyFirstHerkuleXLib_MEGA</div></div>
<p> You can find this code from the menu File &gt; Examples &gt; HerkuleXLib &gt; MyFirstHerkuleXLib_MEGA</p>
<p>The same example is available for Arduino UNO in the menu File &gt; Examples &gt; HerkuleXLib &gt; MyFirstHerkuleXLib_UNO. As said in <a class="el" href="index.html#limitations">Limitations</a>, there no possible printout to serial monitor with the Arduino UNO.</p>
<h1><a class="anchor" id="license"></a>
License</h1>
<p>This project is released under the GNU GPL V3 (see <a href="http://www.gnu.org/licenses/gpl-3.0.en.html">http://www.gnu.org/licenses/gpl-3.0.en.html</a>).</p>
<h1><a class="anchor" id="author"></a>
Author</h1>
<p>Email: <a href="#" onclick="location.href='mai'+'lto:'+'con'+'ta'+'ct@'+'be'+'noi'+'tp'+'uel'+'.c'+'om'; return false;">conta<span style="display: none;">.nosp@m.</span>ct@b<span style="display: none;">.nosp@m.</span>enoit<span style="display: none;">.nosp@m.</span>puel<span style="display: none;">.nosp@m.</span>.com</a> <br />
Web: <a href="http://www.benoitpuel.com">http://www.benoitpuel.com</a> <br />
Author: Benoit Puel </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
